{"version":3,"file":"index-B9KUrNuD.js","sources":["../../../app/administration/src/module/sw-extension-store/page/sw-extension-store-index/sw-extension-store-index.html.twig","../../../app/administration/src/module/sw-extension-store/page/sw-extension-store-index/index.js"],"sourcesContent":["{% block sw_extension_store_index %}\n    <sw-meteor-page class=\"sw-extension-store-index\" hide-icon>\n        {% block sw_extension_store_index_slots %}\n            {% block sw_extension_store_index_slot_search_bar %}\n                <template #search-bar>\n                    {% block sw_extension_store_index_search_bar %}\n                        <sw-search-bar\n                            :key=\"storeSearchKey\"\n                            :initial-search=\"searchValue\"\n                            initial-search-type=\"extension\"\n                            :placeholder=\"$t('sw-extension-store.listing.placeholderSearchBar')\"\n                            @search=\"updateSearch\"\n                        />\n                    {% endblock %}\n                </template>\n            {% endblock %}\n\n            {% block sw_extension_store_index_slot_tabs %}\n                <template #page-tabs>\n                    {% block sw_extension_store_index_tabs %}\n                        {% block sw_extension_store_index_tabs_extensions_app %}\n                            <sw-tabs-item :route=\"{ name: 'sw.extension.store.listing.app' }\" :disabled=\"!isAvailable\">\n                                {{ $t('sw-extension-store.tabs.apps') }}\n                            </sw-tabs-item>\n                        {% endblock %}\n\n                        {% block sw_extension_store_index_tabs_extensions_theme %}\n                            <sw-tabs-item :route=\"{ name: 'sw.extension.store.listing.theme' }\" :disabled=\"!isAvailable\">\n                                {{ $t('sw-extension-store.tabs.themes') }}\n                            </sw-tabs-item>\n                        {% endblock %}\n                    {% endblock %}\n                </template>\n            {% endblock %}\n\n            {% block sw_extension_store_index_slot_default %}\n                <template #default>\n\n                    {% block sw_extension_store_index_loader %}\n                        <sw-loader v-if=\"isLoading\" />\n                    {% endblock %}\n\n                    <template v-else>\n                        {% block sw_extension_store_index_content %}\n                            {% block sw_extension_store_index_content_view %}\n                                <router-view\n                                    v-if=\"isAvailable\"\n                                    @extension-listing-errors=\"onExtensionListingError\"\n                                />\n                            {% endblock %}\n\n                            {% block sw_extension_store_index_content_offline_warning %}\n                                <sw-extension-store-error-card\n                                    v-else-if=\"failReason === 'offline'\"\n                                    :title=\"$t('sw-extension-store.offline.headline')\"\n                                    variant=\"danger\"\n                                >\n                                    {{ $t('sw-extension-store.offline.description') }}\n                                </sw-extension-store-error-card>\n                            {% endblock %}\n\n                            {% block sw_extension_store_index_content_update_warning %}\n                                <sw-extension-store-update-warning v-else-if=\"failReason === 'outdated'\" />\n                            {% endblock %}\n\n                            {% block sw_extension_store_index_content_listing_error %}\n                                <sw-extension-store-error-card\n                                    v-else\n                                    :title=\"listingError?.title\"\n                                    variant=\"danger\"\n                                >\n                                    <template v-if=\"listingError\">\n                                        {{ listingError.message }}\n                                    </template>\n                                </sw-extension-store-error-card>\n                            {% endblock %}\n                        {% endblock %}\n                    </template>\n                </template>\n            {% endblock %}\n        {% endblock %}\n    </sw-meteor-page>\n{% endblock %}\n","import template from './sw-extension-store-index.html.twig';\nimport './sw-extension-store-index.scss';\n\n/**\n * @private\n */\nexport default {\n    template,\n\n    inject: ['extensionStoreActionService', 'shopwareExtensionService', 'feature'],\n\n    props: {\n        id: {\n            type: String,\n            required: false,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            isAvailable: false,\n            failReason: '',\n            listingError: null,\n            isLoading: false,\n        };\n    },\n\n    computed: {\n        storeSearchKey() {\n            return this.$route.name;\n        },\n\n        activeFilters() {\n            return Shopware.Store.get('shopwareExtensions').search.filter;\n        },\n\n        searchValue() {\n            return Shopware.Store.get('shopwareExtensions').search.term;\n        },\n\n        isTheme() {\n            const isTheme = this.$route.name.includes('theme');\n\n            return isTheme ? 'themes' : 'apps';\n        },\n    },\n\n    watch: {\n        isTheme: {\n            immediate: true,\n            handler(newValue) {\n                Shopware.Store.get('shopwareExtensions').setSearchValue({\n                    key: 'page',\n                    value: this.isTheme === this.activeFilters.group ? Shopware.Store.get('shopwareExtensions').search.page : 1,\n                });\n                this.activeFilters.group = newValue;\n            },\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.checkStoreUpdates();\n        },\n\n        async checkStoreUpdates() {\n            this.isLoading = true;\n\n            this.shopwareExtensionService.updateExtensionData();\n\n            const extensionStore = await this.getExtensionStore();\n\n            if (!extensionStore) {\n                this.isLoading = false;\n                return;\n            }\n\n            if (this.isUpdateable(extensionStore)) {\n                this.isAvailable = false;\n                this.failReason = 'outdated';\n                this.isLoading = false;\n                return;\n            }\n\n            this.isAvailable = true;\n            this.isLoading = false;\n        },\n\n        onExtensionListingError(e) {\n            const errors = Shopware.Service('extensionErrorService').handleErrorResponse(e, this);\n\n            this.isAvailable = false;\n            this.listingError = errors && errors[0];\n            this.failReason = 'listing_error';\n        },\n\n        getExtensionStore() {\n            return this.extensionStoreActionService.getMyExtensions().then((extensions) => {\n                return extensions.find(extension => extension.name === 'SwagExtensionStore');\n            });\n        },\n\n        isUpdateable(extension) {\n            if (!extension || extension.latestVersion === null) {\n                return false;\n            }\n\n            return extension.latestVersion !== extension.version;\n        },\n\n        updateSearch(term) {\n            Shopware.Store.get('shopwareExtensions').setSearchValue({\n                key: 'term',\n                value: term,\n            });\n        },\n    },\n};\n"],"names":["template","index","newValue","extensionStore","errors","extensions","extension","term"],"mappings":"AAAA,MAAAA,EAAe,ovECMfC,EAAe,CACX,SAAAD,EAEA,OAAQ,CAAC,8BAA+B,2BAA4B,SAAS,EAE7E,MAAO,CACH,GAAI,CACA,KAAM,OACN,SAAU,GACV,QAAS,IACrB,CACA,EAEI,MAAO,CACH,MAAO,CACH,YAAa,GACb,WAAY,GACZ,aAAc,KACd,UAAW,EACvB,CACA,EAEI,SAAU,CACN,gBAAiB,CACb,OAAO,KAAK,OAAO,IAC/B,EAEQ,eAAgB,CACZ,OAAO,SAAS,MAAM,IAAI,oBAAoB,EAAE,OAAO,MACnE,EAEQ,aAAc,CACV,OAAO,SAAS,MAAM,IAAI,oBAAoB,EAAE,OAAO,IACnE,EAEQ,SAAU,CAGN,OAFgB,KAAK,OAAO,KAAK,SAAS,OAAO,EAEhC,SAAW,MACxC,CACA,EAEI,MAAO,CACH,QAAS,CACL,UAAW,GACX,QAAQE,EAAU,CACd,SAAS,MAAM,IAAI,oBAAoB,EAAE,eAAe,CACpD,IAAK,OACL,MAAO,KAAK,UAAY,KAAK,cAAc,MAAQ,SAAS,MAAM,IAAI,oBAAoB,EAAE,OAAO,KAAO,CAC9H,CAAiB,EACD,KAAK,cAAc,MAAQA,CAC3C,CACA,CACA,EAEI,SAAU,CACN,KAAK,iBAAgB,CAC7B,EAEI,QAAS,CACL,kBAAmB,CACf,KAAK,kBAAiB,CAClC,EAEQ,MAAM,mBAAoB,CACtB,KAAK,UAAY,GAEjB,KAAK,yBAAyB,oBAAmB,EAEjD,MAAMC,EAAiB,MAAM,KAAK,kBAAiB,EAEnD,GAAI,CAACA,EAAgB,CACjB,KAAK,UAAY,GACjB,MAChB,CAEY,GAAI,KAAK,aAAaA,CAAc,EAAG,CACnC,KAAK,YAAc,GACnB,KAAK,WAAa,WAClB,KAAK,UAAY,GACjB,MAChB,CAEY,KAAK,YAAc,GACnB,KAAK,UAAY,EAC7B,EAEQ,wBAAwB,EAAG,CACvB,MAAMC,EAAS,SAAS,QAAQ,uBAAuB,EAAE,oBAAoB,EAAG,IAAI,EAEpF,KAAK,YAAc,GACnB,KAAK,aAAeA,GAAUA,EAAO,CAAC,EACtC,KAAK,WAAa,eAC9B,EAEQ,mBAAoB,CAChB,OAAO,KAAK,4BAA4B,gBAAe,EAAG,KAAMC,GACrDA,EAAW,KAAKC,GAAaA,EAAU,OAAS,oBAAoB,CAC9E,CACb,EAEQ,aAAaA,EAAW,CACpB,MAAI,CAACA,GAAaA,EAAU,gBAAkB,KACnC,GAGJA,EAAU,gBAAkBA,EAAU,OACzD,EAEQ,aAAaC,EAAM,CACf,SAAS,MAAM,IAAI,oBAAoB,EAAE,eAAe,CACpD,IAAK,OACL,MAAOA,CACvB,CAAa,CACb,CACA,CACA"}