{"version":3,"file":"index-C9VuboZq.js","sources":["../../../app/administration/src/module/sw-extension-store/component/sw-extension-buy-modal/sw-extension-buy-modal.html.twig","../../../app/administration/src/module/sw-extension-store/component/sw-extension-buy-modal/index.js"],"sourcesContent":["{% block sw_extension_buy_modal %}\n<sw-modal\n    class=\"sw-extension-buy-modal\"\n    :title=\"$t('sw-extension-store.component.sw-extension-buy-modal.title')\"\n    size=\"450px\"\n    :is-loading=\"isLoading\"\n    @modal-close=\"emitClose\"\n>\n\n    {% block sw_extension_buy_modal_content %}\n        <template v-if=\"checkoutStep === checkoutSteps.SUCCESS\">\n            {% block sw_extension_buy_modal_adding_success_content %}\n                <sw-extension-adding-success\n                    @close=\"emitClose\"\n                />\n            {% endblock %}\n        </template>\n\n        <template v-else-if=\"checkoutStep === checkoutSteps.FAILED\">\n            {% block sw_extension_buy_modal_adding_failed_content %}\n                <sw-extension-adding-failed\n                    :extension-name=\"extension.name\"\n                    :title=\"checkoutError && checkoutError.title\"\n                    :detail=\"checkoutError && checkoutError.detail\"\n                    :documentation-link=\"checkoutErrorDocumentationLink\"\n                    @close=\"emitClose\"\n                />\n            {% endblock %}\n        </template>\n\n        <template v-else>\n            {% block sw_extension_buy_modal_content_not_installed %}\n                {% block sw_extension_buy_modal_variant_selection %}\n                    <div\n                        class=\"sw-extension-buy-modal__variants-selection\"\n                        :class=\"{'sw-extension-buy-modal__variants-selection-single-entry': recommendedVariants.length <= 1}\"\n                    >\n                        {% block sw_extension_buy_modal_variant_selection_content %}\n                            {% block sw_extension_buy_modal_variant_selection_extension_preview %}\n                                <div class=\"sw-extension-buy-modal__extension-summary\">\n                                    {% block sw_extension_buy_modal_variant_selection_extension_preview_content %}\n                                        {% block sw_extension_buy_modal_variant_selection_extension_icon %}\n                                            <sw-extension-icon :src=\"extension.icon\" />\n                                        {% endblock %}\n\n                                        {% block sw_extension_buy_modal_variant_selection_extension_name %}\n                                            <h4 class=\"sw-extension-buy-modal__extension-summary-name\">\n                                                {{ extension.label }}\n                                            </h4>\n                                        {% endblock %}\n                                    {% endblock %}\n                                </div>\n                            {% endblock %}\n\n                            {% block sw_extension_buy_modal_variant_selection_variant_list %}\n                                <ul>\n                                    {% block sw_extension_buy_modal_variant_selection_variant_list_item %}\n                                        <li\n                                            v-for=\"variant in recommendedVariants\"\n                                            :key=\"variant.id\"\n                                            class=\"sw-extension-buy-modal__variants-card\"\n                                            :class=\"variantCardClass(variant)\"\n                                            @click=\"onChangeVariantSelection(variant)\"\n                                        >\n\n                                            {% block sw_extension_buy_modal_variant_selection_variant_list_item_radio_button %}\n                                                <div class=\"sw-extension-buy-modal__variants-card-input sw-field--radio\">\n                                                    <div class=\"sw-field__radio-input\">\n                                                        <input\n                                                            :id=\"`sw-extension-buy-modal__variant-${variant.type}`\"\n                                                            type=\"radio\"\n                                                            name=\"variant-selection\"\n                                                            :value=\"variant.id\"\n                                                            :checked=\"variant.id === selectedVariantId\"\n                                                            :disabled=\"isLoading\"\n                                                        >\n                                                        <div class=\"sw-field__radio-state\" />\n                                                    </div>\n                                                </div>\n                                            {% endblock %}\n\n                                            {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label %}\n                                                {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_description %}\n                                                    <label\n                                                        :for=\"`sw-extension-buy-modal__variant-${variant.type}`\"\n                                                        class=\"sw-extension-buy-modal__variant-description\"\n                                                    >\n                                                        {{ variant.label || variant.type }}\n                                                    </label>\n                                                {% endblock %}\n\n                                                {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_rent %}\n                                                    <div\n                                                        v-if=\"variant.type === 'rent'\"\n                                                        class=\"sw-extension-buy-modal__rent\"\n                                                    >\n\n                                                        {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_rent_prices %}\n                                                            <i18n-t\n                                                                keypath=\"sw-extension-store.buy-modal.rent.priceDisplay\"\n                                                                tag=\"span\"\n                                                                :class=\"getDiscountClasses(variant)\"\n                                                            >\n                                                                <template #priceDisplay>\n                                                                    <span class=\"sw-extension-buy-modal__list-price\">{{ renderPrice(variant.netPrice) }}</span>\n                                                                    <span v-if=\"hasDiscount(variant)\" class=\"sw-extension-buy-modal__discounted-price\">{{ getDiscountPrice(variant) }}</span>\n                                                                </template>\n                                                            </i18n-t>\n                                                        {% endblock %}\n\n                                                        {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_rent_trial %}\n                                                            <div v-if=\"variant.trialPhaseIncluded && firstMonthFree\">\n                                                                {{ $t('sw-extension-store.buy-modal.rent.freeTrial') }}\n                                                            </div>\n                                                        {% endblock %}\n\n                                                        {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_rent_disclaimer %}\n                                                            <div>{{ $t('sw-extension-store.buy-modal.rent.disclaimer') }}</div>\n                                                        {% endblock %}\n                                                    </div>\n                                                {% endblock %}\n\n                                                {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_buy %}\n                                                    <div\n                                                        v-else-if=\"variant.type === 'buy'\"\n                                                        :class=\"getDiscountClasses(variant)\"\n                                                    >\n\n                                                        {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_buy_prices %}\n                                                            <span\n                                                                v-if=\"hasDiscount(variant)\"\n                                                                class=\"sw-extension-buy-modal__list-price\"\n                                                            >\n                                                                {{ renderPrice(variant.netPrice) }}\n                                                            </span>\n                                                            <span class=\"sw-extension-buy-modal__discounted-price\">{{ renderBuyPrice(variant) }}</span>\n                                                        {% endblock %}\n                                                    </div>\n                                                {% endblock %}\n\n                                                {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_fallback %}\n                                                    <span\n                                                        v-else\n                                                        class=\"sw-extension-buy-modal__display-default-price\"\n                                                    >\n                                                        {{ renderPrice(variant.netPrice) }}\n                                                    </span>\n                                                {% endblock %}\n\n                                                {% block sw_extension_buy_modal_variant_selection_variant_list_item_variant_label_legal %}\n                                                    <span\n                                                        v-if=\"variant.legalText\"\n                                                        class=\"sw-extension-buy-modal__variant-text-block\"\n                                                        v-html=\"legalTextForVariant(variant)\"\n                                                    />\n                                                {% endblock %}\n                                            {% endblock %}\n                                        </li>\n                                    {% endblock %}\n                                </ul>\n                            {% endblock %}\n                        {% endblock %}\n                    </div>\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_summary %}\n                    <div class=\"sw-extension-buy-modal__variant-summary\">\n                        {% block sw_extension_buy_modal_summary_content %}\n                            {% block sw_extension_buy_modal_summary_price %}\n                                <p class=\"sw-extension-buy-modal__variant-summary-price\">\n                                    {% block sw_extension_buy_modal_summary_price_content %}\n                                        {% block sw_extension_buy_modal_summary_label_price %}\n                                            <span>\n                                                {{ $t('sw-extension-store.component.sw-extension-buy-modal.variantSummary.labelPrice') }}\n                                            </span>\n                                        {% endblock %}\n\n                                        {% block sw_extension_buy_modal_summary_actual_price %}\n                                            <span\n                                                v-if=\"!isLoading\"\n                                                class=\"sw-extension-buy-modal__variant-summary-actual-price\"\n                                            >\n                                                {{ $t('sw-extension-store.general.labelPrice', { price: formattedPrice }, variantRecommendation(selectedVariant)) }}\n                                            </span>\n                                        {% endblock %}\n                                    {% endblock %}\n                                </p>\n                            {% endblock %}\n\n                            {% block sw_extension_buy_modal_summary_label_plus_vat %}\n                                <p\n                                    class=\"sw-extension-buy-modal__variant-summary-price-subline\"\n                                    :class=\"vatIncludedClasses\"\n                                >\n                                    {{ $t('sw-extension-store.component.sw-extension-buy-modal.variantSummary.labelVat') }}\n                                </p>\n                            {% endblock %}\n\n                            {% block sw_extension_buy_modal_summary_renewal_date %}\n                                <p\n                                    class=\"sw-extension-buy-modal__variant-summary-price-subline\"\n                                    :class=\"renewalDateClasses\"\n                                >\n                                    {{ $t('sw-extension-store.component.sw-extension-buy-modal.variantSummary.renewal', { renewalDate: dateFilter(todayPlusOneMonth) }, 0) }}\n                                </p>\n                            {% endblock %}\n                        {% endblock %}\n                    </div>\n                {% endblock %}\n\n                {% block sw_extension_payment_selection %}\n                    <sw-single-select\n                        v-if=\"showPaymentSelection\"\n                        v-model:value=\"selectedPaymentMean\"\n                        :options=\"paymentMeans\"\n                        :placeholder=\"$t('sw-extension-store.buy-modal.paymentSelectionPlaceholder')\"\n                        value-property=\"id\"\n                    />\n                {% endblock %}\n\n                {% block sw_extension_payment_general_text_block %}\n                    <p\n                        v-if=\"paymentText\"\n                        class=\"sw-extension-buy-modal__general-text-block\"\n                        v-html=\"paymentText\"\n                    />\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_accept_toc %}\n                    <sw-gtc-checkbox\n                        v-model:value=\"tocAccepted\"\n                        class=\"sw-extension-buy-modal__checkbox\"\n                    />\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_accept_extension_permissions %}\n                    <mt-checkbox\n                        v-if=\"extensionHasPermissions\"\n                        v-model:checked=\"permissionsAccepted\"\n                        class=\"sw-extension-buy-modal__checkbox sw-extension-buy-modal__checkbox-permissions\"\n                        :class=\"`sw-extension-buy-modal__checkbox-permissions--${extension.name}`\"\n                    >\n                        <template #label>\n                            <span v-if=\"legalText\">\n                                {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.introText') }}\n                                <mt-link\n                                    class=\"link permissions-modal-trigger\"\n                                    as=\"a\"\n                                    @click=\"openPermissionsModal\"\n                                >\n                                    {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.buttonPermissions') }}\n                                </mt-link>\n                                {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.middleText') }}\n                                <mt-link\n                                    class=\"link legal-text-modal-trigger\"\n                                    as=\"a\"\n                                    @click=\"openLegalTextModal\"\n                                >\n                                    {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.buttonAppProvider') }}\n                                </mt-link>\n                                {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.endText') }}\n                            </span>\n\n                            <span v-else>\n                                {{ $t('sw-extension-store.component.sw-extension-buy-modal.labelAcceptPermissions') }}\n                                <mt-link\n                                    class=\"link permissions-modal-trigger\"\n                                    as=\"a\"\n                                    @click=\"openPermissionsModal\"\n                                >\n                                    {{ $t('sw-extension-store.detail.labelButtonShowPermissions') }}\n                                </mt-link>\n                            </span>\n                        </template>\n                    </mt-checkbox>\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_accept_extension_app_provider %}\n                    <mt-checkbox\n                        v-if=\"!extensionHasPermissions && legalText\"\n                        v-model:checked=\"legalTextAccepted\"\n                        class=\"sw-extension-buy-modal__checkbox sw-extension-buy-modal__checkbox-app-provider\"\n                        :class=\"`sw-extension-buy-modal__checkbox-app-provider--${extension.name}`\"\n                    >\n                        <template #label>\n                            {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.appProviderStartText') }}\n                            <mt-link\n                                class=\"link legal-text-modal-trigger\"\n                                as=\"a\"\n                                @click=\"openLegalTextModal\"\n                            >\n                                {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.buttonAppProvider') }}\n                            </mt-link>\n                            {{ $t('sw-extension-store.buy-modal.checkboxes.permissionsAndAppProvider.endText') }}\n                        </template>\n                    </mt-checkbox>\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_accept_extension_privacy_policy_extensions %}\n                    <mt-checkbox\n                        v-if=\"extension.privacyPolicyExtension\"\n                        v-model:checked=\"privacyExtensionsAccepted\"\n                        class=\"sw-extension-buy-modal__checkbox-privacy-policy\"\n                        :class=\"`sw-extension-buy-modal__checkbox-privacy-policy--${extension.name}`\"\n                    >\n                        <template #label>\n                            <span class=\"is--required\">\n                                {{ $t('sw-extension-store.component.sw-extension-buy-modal.labelAcceptPrivacyExtensions') }}\n                            </span>\n                            <mt-link\n                                class=\"link privacy-policy-modal-trigger\"\n                                as=\"a\"\n                                @click=\"openPrivacyModal\"\n                            >\n                                {{ $t('sw-extension-store.component.sw-extension-buy-modal.buttonShowPrivacyExtensions') }}\n                            </mt-link>\n                        </template>\n                    </mt-checkbox>\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_alert_can_not_buy %}\n                    <mt-banner v-if=\"!userCanBuyFromStore\" variant=\"info\">\n                        {% block sw_extension_buy_modal_alert_can_not_buy_content %}\n                            {{ $t('sw-extension-store.component.sw-extension-buy-modal.alertCanNotBuy.text') }}\n                        {% endblock %}\n                    </mt-banner>\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_alert_payment_means_required %}\n                    <mt-banner v-if=\"showPaymentWarning\" variant=\"attention\">\n                        {% block sw_extension_buy_modal_alert_payment_means_required_content %}\n                            {{ $t('sw-extension-store.buy-modal.warnings.paymentMeansRequiredText') }}\n                            <sw-external-link\n                                :href=\"cart && cart.payment && cart.payment.registrationUrl\"\n                                class=\"sw-extension-buy-modal__external-link\"\n                            >\n                                {{ $t('sw-extension-store.buy-modal.warnings.paymentMeansRequiredLinkText') }}\n                                <mt-icon name=\"regular-long-arrow-right\" />\n                            </sw-external-link>\n                        {% endblock %}\n                    </mt-banner>\n                {% endblock %}\n\n                {% block sw_extension_buy_modal_button_purchase %}\n                    <mt-button\n                        variant=\"primary\"\n                        block\n                        :disabled=\"!canPurchaseExtension\"\n                        @click=\"purchaseExtension\"\n                    >\n                        {{ purchaseButtonLabel }}\n                    </mt-button>\n                {% endblock %}\n            {% endblock %}\n\n            {% block sw_extension_buy_modal_permissions_modal %}\n                <sw-extension-permissions-modal\n                    v-if=\"showPermissionsModal\"\n                    :extension-label=\"extension.label\"\n                    :domains=\"extension.domains\"\n                    :permissions=\"extension.permissions\"\n                    @modal-close=\"closePermissionsModal\"\n                />\n            {% endblock %}\n\n            {% block sw_extension_buy_modal_privacy_extensions_modal %}\n                <sw-extension-privacy-policy-extensions-modal\n                    v-if=\"showPrivacyModal\"\n                    :extension-name=\"extension.label\"\n                    :privacy-policy-extension=\"extension.privacyPolicyExtension\"\n                    @modal-close=\"closePrivacyModal\"\n                />\n            {% endblock %}\n\n            {% block sw_extension_buy_modal_legal_text_modal %}\n                <sw-modal\n                    v-if=\"showLegalTextModal\"\n                    class=\"sw-extension-buy-modal__legal-text-modal\"\n                    :title=\"$t('sw-extension-store.buy-modal.legalTextModal.title')\"\n                    @modal-close=\"closeLegalTextModal\"\n                >\n                    <div v-html=\"legalText\" />\n\n                    <template #modal-footer>\n                        <mt-button\n                            variant=\"primary\"\n                            size=\"small\"\n                            @click=\"closeLegalTextModal\"\n                        >\n                            {{ $t('global.default.close') }}\n                        </mt-button>\n                    </template>\n                </sw-modal>\n            {% endblock %}\n        </template>\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n","import template from './sw-extension-buy-modal.html.twig';\nimport './sw-extension-buy-modal.scss';\n\nconst { Utils } = Shopware;\n\n/**\n * @private\n */\nexport default {\n    template,\n\n    inject: [\n        'shopwareExtensionService',\n        'extensionStoreLicensesService',\n    ],\n\n    emits: [\n        'modal-close',\n    ],\n\n    mixins: [\n        'sw-extension-error',\n    ],\n\n    props: {\n        extension: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            tocAccepted: false,\n            selectedVariantId: null,\n            isLoading: false,\n            permissionsAccepted: false,\n            legalTextAccepted: false,\n            showPermissionsModal: false,\n            showLegalTextModal: false,\n            privacyExtensionsAccepted: false,\n            showPrivacyModal: false,\n            checkoutStep: null,\n            checkoutError: null,\n            cart: null,\n            paymentMeans: [],\n        };\n    },\n\n    computed: {\n        recommendedVariants() {\n            return this.shopwareExtensionService.orderVariantsByRecommendation(this.extension.variants);\n        },\n\n        selectedVariant() {\n            return this.extension.variants.find((variant) => {\n                return variant.id === this.selectedVariantId;\n            });\n        },\n\n        todayPlusOneMonth() {\n            const date = new Date();\n            date.setMonth(date.getMonth() + 1);\n\n            return date;\n        },\n\n        dateFilter() {\n            return Utils.format.date;\n        },\n\n        formattedPrice() {\n            const cartPosition = this.cart && this.cart.positions && this.cart.positions[0];\n            const netPrice = cartPosition && cartPosition.netPrice;\n\n            if (netPrice && cartPosition && cartPosition.firstMonthFree) {\n                return Utils.format.currency(0, 'EUR');\n            }\n\n            if (netPrice) {\n                return Utils.format.currency(netPrice, 'EUR', 2);\n            }\n\n            return Utils.format.currency(\n                this.shopwareExtensionService.getPriceFromVariant(this.selectedVariant),\n                'EUR',\n            );\n        },\n\n        trialPrice() {\n            return this.renderPrice(0);\n        },\n\n        purchaseButtonLabel() {\n            switch (this.selectedVariant.type) {\n                case this.shopwareExtensionService.EXTENSION_VARIANT_TYPES.FREE:\n                    return this.$t('sw-extension-store.component.sw-extension-buy-modal.purchaseButtonsLabels.free');\n\n                case this.shopwareExtensionService.EXTENSION_VARIANT_TYPES.RENT:\n                    return this.$t('sw-extension-store.component.sw-extension-buy-modal.purchaseButtonsLabels.rent');\n\n                case this.shopwareExtensionService.EXTENSION_VARIANT_TYPES.BUY:\n                default:\n                    return this.$t('sw-extension-store.component.sw-extension-buy-modal.purchaseButtonsLabels.buy');\n            }\n        },\n\n        vatIncludedClasses() {\n            return {\n                'is--hidden': this.selectedVariant.type === this.shopwareExtensionService.EXTENSION_VARIANT_TYPES.FREE,\n            };\n        },\n\n        renewalDateClasses() {\n            return {\n                'is--hidden': this.selectedVariant.type !== this.shopwareExtensionService.EXTENSION_VARIANT_TYPES.RENT,\n            };\n        },\n\n        extensionHasPermissions() {\n            return !!Object.keys(this.extension.permissions).length;\n        },\n\n        canPurchaseExtension() {\n            return this.tocAccepted &&\n                this.permissionsAccepted &&\n                this.legalTextAccepted &&\n                this.privacyExtensionsAccepted &&\n                this.userCanBuyFromStore &&\n                !this.showPaymentWarning;\n        },\n\n        /* onPrem we need to check if the user is connected to the store in saas we check if the user has a plan */\n        userCanBuyFromStore() {\n            // Trigger for recompute value\n\n            const _trigger = this.tocAccepted;\n\n            return Shopware.Store.get('shopwareExtensions').userInfo !== null;\n        },\n\n        showPaymentWarning() {\n            return (this.paymentMeans || []).length <= 0 &&\n                this.cart && this.cart.payment && this.cart.payment.paymentMeanRequired;\n        },\n\n        checkoutSteps() {\n            return Object.freeze({\n                CHECKOUT: null,\n                SUCCESS: 'checkout-success',\n                FAILED: 'checkout-failed',\n            });\n        },\n\n        showPaymentSelection() {\n            return (this.paymentMeans || []).length > 0 &&\n                this.cart && this.cart.payment && this.cart.payment.paymentMeanRequired;\n        },\n\n        paymentText() {\n            if (!this.cart || !this.cart.payment || !this.cart.payment.paymentText) {\n                return null;\n            }\n\n            return this.$sanitize(this.cart.payment.paymentText, {\n                ALLOWED_TAGS: ['a', 'b', 'i', 'u', 'br', 'strong', 'p', 'br'],\n                ALLOWED_ATTR: ['href', 'target', 'rel'],\n            });\n        },\n\n        legalText() {\n            if (!this.cart || !this.cart.legalText) {\n                return null;\n            }\n\n            return this.$sanitize(this.cart.legalText, {\n                ALLOWED_TAGS: ['a', 'b', 'i', 'u', 'br', 'strong', 'p', 'br'],\n                ALLOWED_ATTR: ['href', 'target', 'rel'],\n            });\n        },\n\n        selectedPaymentMean: {\n            get() {\n                return this.cart &&\n                    this.cart.payment &&\n                    this.cart.payment.paymentMean &&\n                    this.cart.payment.paymentMean.id;\n            },\n            set(paymentId) {\n                if (this.cart && this.cart.payment && this.cart.payment.paymentMean) {\n                    this.cart.payment.paymentMean.id = paymentId;\n                }\n\n                this.cart.payment.paymentMean = {\n                    id: paymentId,\n                };\n            },\n        },\n\n        checkoutErrorDocumentationLink() {\n            return Utils.get(this.checkoutError, 'meta.documentationLink', null);\n        },\n\n        firstMonthFree() {\n            return this.cart && this.cart.positions[0] && this.cart.positions[0].firstMonthFree === true;\n        },\n    },\n\n    async created() {\n        const variantId = this.recommendedVariants.length > 0 ? this.recommendedVariants[0].id : null;\n\n        this.setSelectedVariantId(variantId);\n        this.permissionsAccepted = !this.extensionHasPermissions;\n        this.privacyExtensionsAccepted = !this.extension.privacyPolicyExtension;\n\n        await this.fetchPlan();\n\n        this.legalTextAccepted = !this.legalText;\n    },\n\n    watch: {\n        selectedVariantId() {\n            this.getCart();\n        },\n\n        /**\n         * userCanBuyFromStore is used in the getCart() method to make an early return\n         *\n         * @param value\n         */\n        userCanBuyFromStore(value) {\n            if (value) {\n                this.getCart();\n            }\n        },\n\n        /**\n         * Watcher to automatically sync the `legalTextAccepted` value with the permissions.\n         * When an App has permissions which need to be accepted, the permissions automatically accept\n         * the `legalText` as well because for Apps they are combined in a single checkbox.\n         *\n         * @param value\n         */\n        permissionsAccepted(value) {\n            this.legalTextAccepted = value;\n        },\n    },\n\n    methods: {\n        emitClose() {\n            if (this.isLoading) {\n                return;\n            }\n\n            this.$emit('modal-close');\n        },\n\n        setSelectedVariantId(variantId) {\n            if (this.isLoading) {\n                return;\n            }\n\n            this.selectedVariantId = variantId;\n        },\n\n        variantCardClass(variant) {\n            return {\n                'is--selected': variant.id === this.selectedVariantId,\n            };\n        },\n\n        onChangeVariantSelection(variant) {\n            this.setSelectedVariantId(variant.id);\n        },\n\n        variantRecommendation(variant) {\n            return this.shopwareExtensionService.mapVariantToRecommendation(variant);\n        },\n\n        async purchaseExtension() {\n            this.isLoading = true;\n\n            let checkoutResult = null;\n\n            try {\n                await this.orderCart();\n\n                await this.shopwareExtensionService.updateExtensionData();\n                checkoutResult = this.checkoutSteps.SUCCESS;\n            } catch (error) {\n                this.handleErrors(error);\n                checkoutResult = this.checkoutSteps.FAILED;\n\n                if (Utils.get(error, 'response.data.errors[0]', null)) {\n                    this.checkoutError = error.response.data.errors[0];\n                }\n            } finally {\n                await this.shopwareExtensionService.updateExtensionData();\n                this.checkoutStep = checkoutResult;\n\n                this.isLoading = false;\n            }\n        },\n\n        async orderCart() {\n            await this.extensionStoreLicensesService.orderCart(this.cart);\n        },\n\n        async getCart() {\n            if (!this.userCanBuyFromStore) {\n                return;\n            }\n\n            this.isLoading = true;\n\n            try {\n                const response = await this.extensionStoreLicensesService.newCart(this.extension.id, this.selectedVariantId);\n                this.cart = response.data;\n            } catch (error) {\n                this.handleErrors(error);\n                this.isLoading = false;\n                this.emitClose();\n            } finally {\n                this.isLoading = false;\n            }\n        },\n\n        getDiscountClasses(variant) {\n            return {\n                'is--discounted': this.hasDiscount(variant),\n            };\n        },\n\n        hasDiscount(variant) {\n            const campaign = variant.discountCampaign;\n            return campaign\n                && new Date(Date.parse(campaign.startDate)) < (new Date())\n                && new Date(Date.parse(campaign.endDate)) >= (new Date());\n        },\n\n        renderPrice(price) {\n            return Utils.format.currency(price, 'EUR');\n        },\n\n        renderBuyPrice(variant) {\n            if (this.hasDiscount(variant)) {\n                return this.renderPrice(variant.discountCampaign.discountedPrice);\n            }\n\n            return this.renderPrice(variant.netPrice);\n        },\n\n        getDiscountPrice(variant) {\n            return variant.discountCampaign ? this.renderPrice(variant.discountCampaign.discountedPrice) : this.trialPrice;\n        },\n\n        getDiscountEnds(variant) {\n            return Utils.format.date(\n                variant.discountCampaign ? new Date(Date.parse(variant.discountCampaign.endDate)) : null,\n            );\n        },\n\n        handleErrors(error) {\n            this.showExtensionErrors(error);\n        },\n\n        openPermissionsModal() {\n            this.showPermissionsModal = true;\n        },\n\n        closePermissionsModal() {\n            this.showPermissionsModal = false;\n        },\n\n        openLegalTextModal() {\n            this.showLegalTextModal = true;\n        },\n\n        closeLegalTextModal() {\n            this.showLegalTextModal = false;\n        },\n\n        async fetchPlan() {\n            this.isLoading = true;\n            await this.shopwareExtensionService.checkLogin();\n            await this.getPaymentMeans();\n            this.isLoading = false;\n        },\n\n        async getPaymentMeans() {\n            this.extensionStoreLicensesService.getPaymentMeans().then((response) => {\n                this.paymentMeans = response.data;\n            }).catch(error => {\n                const errorMessages = (error.response && error.response.data && error.response.data.errors) || [];\n\n                if (!Array.isArray(errorMessages)) {\n                    Shopware.Utils.debug.warn('Payment loading error', error);\n                    return;\n                }\n\n                errorMessages.forEach(e => {\n                    this.createNotificationError({\n                        system: true,\n                        autoClose: false,\n                        growl: true,\n                        title: e.title,\n                        message: e.detail,\n                    });\n                });\n            });\n        },\n\n        legalTextForVariant(variant) {\n            if (!variant || !variant.legalText) {\n                return null;\n            }\n\n            return this.$sanitize(variant.legalText, {\n                ALLOWED_TAGS: ['a', 'b', 'i', 'u', 'br', 'strong', 'p', 'br'],\n                ALLOWED_ATTR: ['href', 'target', 'rel'],\n            });\n        },\n\n        openPrivacyModal() {\n            this.showPrivacyModal = true;\n        },\n\n        closePrivacyModal() {\n            this.showPrivacyModal = false;\n        },\n    },\n};\n"],"names":["template","Utils","index","variant","date","cartPosition","netPrice","paymentId","variantId","value","checkoutResult","error","response","campaign","price","errorMessages","e"],"mappings":"AAAA,MAAAA,EAAe,upXCGT,CAAE,MAAAC,CAAK,EAAK,SAKlBC,EAAe,CACX,SAAAF,EAEA,OAAQ,CACJ,2BACA,+BACR,EAEI,MAAO,CACH,aACR,EAEI,OAAQ,CACJ,oBACR,EAEI,MAAO,CACH,UAAW,CACP,KAAM,OACN,SAAU,EACtB,CACA,EAEI,MAAO,CACH,MAAO,CACH,YAAa,GACb,kBAAmB,KACnB,UAAW,GACX,oBAAqB,GACrB,kBAAmB,GACnB,qBAAsB,GACtB,mBAAoB,GACpB,0BAA2B,GAC3B,iBAAkB,GAClB,aAAc,KACd,cAAe,KACf,KAAM,KACN,aAAc,CAAA,CAC1B,CACA,EAEI,SAAU,CACN,qBAAsB,CAClB,OAAO,KAAK,yBAAyB,8BAA8B,KAAK,UAAU,QAAQ,CACtG,EAEQ,iBAAkB,CACd,OAAO,KAAK,UAAU,SAAS,KAAMG,GAC1BA,EAAQ,KAAO,KAAK,iBAC9B,CACb,EAEQ,mBAAoB,CAChB,MAAMC,EAAO,IAAI,KACjB,OAAAA,EAAK,SAASA,EAAK,SAAQ,EAAK,CAAC,EAE1BA,CACnB,EAEQ,YAAa,CACT,OAAOH,EAAM,OAAO,IAChC,EAEQ,gBAAiB,CACb,MAAMI,EAAe,KAAK,MAAQ,KAAK,KAAK,WAAa,KAAK,KAAK,UAAU,CAAC,EACxEC,EAAWD,GAAgBA,EAAa,SAE9C,OAAIC,GAAYD,GAAgBA,EAAa,eAClCJ,EAAM,OAAO,SAAS,EAAG,KAAK,EAGrCK,EACOL,EAAM,OAAO,SAASK,EAAU,MAAO,CAAC,EAG5CL,EAAM,OAAO,SAChB,KAAK,yBAAyB,oBAAoB,KAAK,eAAe,EACtE,KAChB,CACA,EAEQ,YAAa,CACT,OAAO,KAAK,YAAY,CAAC,CACrC,EAEQ,qBAAsB,CAClB,OAAQ,KAAK,gBAAgB,KAAI,CAC7B,KAAK,KAAK,yBAAyB,wBAAwB,KACvD,OAAO,KAAK,GAAG,gFAAgF,EAEnG,KAAK,KAAK,yBAAyB,wBAAwB,KACvD,OAAO,KAAK,GAAG,gFAAgF,EAEnG,KAAK,KAAK,yBAAyB,wBAAwB,IAC3D,QACI,OAAO,KAAK,GAAG,+EAA+E,CAClH,CACA,EAEQ,oBAAqB,CACjB,MAAO,CACH,aAAc,KAAK,gBAAgB,OAAS,KAAK,yBAAyB,wBAAwB,IAClH,CACA,EAEQ,oBAAqB,CACjB,MAAO,CACH,aAAc,KAAK,gBAAgB,OAAS,KAAK,yBAAyB,wBAAwB,IAClH,CACA,EAEQ,yBAA0B,CACtB,MAAO,CAAC,CAAC,OAAO,KAAK,KAAK,UAAU,WAAW,EAAE,MAC7D,EAEQ,sBAAuB,CACnB,OAAO,KAAK,aACR,KAAK,qBACL,KAAK,mBACL,KAAK,2BACL,KAAK,qBACL,CAAC,KAAK,kBACtB,EAGQ,qBAAsB,CAGD,YAAK,YAEf,SAAS,MAAM,IAAI,oBAAoB,EAAE,WAAa,IACzE,EAEQ,oBAAqB,CACjB,OAAQ,KAAK,cAAgB,CAAA,GAAI,QAAU,GACvC,KAAK,MAAQ,KAAK,KAAK,SAAW,KAAK,KAAK,QAAQ,mBACpE,EAEQ,eAAgB,CACZ,OAAO,OAAO,OAAO,CACjB,SAAU,KACV,QAAS,mBACT,OAAQ,iBACxB,CAAa,CACb,EAEQ,sBAAuB,CACnB,OAAQ,KAAK,cAAgB,CAAA,GAAI,OAAS,GACtC,KAAK,MAAQ,KAAK,KAAK,SAAW,KAAK,KAAK,QAAQ,mBACpE,EAEQ,aAAc,CACV,MAAI,CAAC,KAAK,MAAQ,CAAC,KAAK,KAAK,SAAW,CAAC,KAAK,KAAK,QAAQ,YAChD,KAGJ,KAAK,UAAU,KAAK,KAAK,QAAQ,YAAa,CACjD,aAAc,CAAC,IAAK,IAAK,IAAK,IAAK,KAAM,SAAU,IAAK,IAAI,EAC5D,aAAc,CAAC,OAAQ,SAAU,KAAK,CACtD,CAAa,CACb,EAEQ,WAAY,CACR,MAAI,CAAC,KAAK,MAAQ,CAAC,KAAK,KAAK,UAClB,KAGJ,KAAK,UAAU,KAAK,KAAK,UAAW,CACvC,aAAc,CAAC,IAAK,IAAK,IAAK,IAAK,KAAM,SAAU,IAAK,IAAI,EAC5D,aAAc,CAAC,OAAQ,SAAU,KAAK,CACtD,CAAa,CACb,EAEQ,oBAAqB,CACjB,KAAM,CACF,OAAO,KAAK,MACR,KAAK,KAAK,SACV,KAAK,KAAK,QAAQ,aAClB,KAAK,KAAK,QAAQ,YAAY,EAClD,EACY,IAAIM,EAAW,CACP,KAAK,MAAQ,KAAK,KAAK,SAAW,KAAK,KAAK,QAAQ,cACpD,KAAK,KAAK,QAAQ,YAAY,GAAKA,GAGvC,KAAK,KAAK,QAAQ,YAAc,CAC5B,GAAIA,CACxB,CACA,CACA,EAEQ,gCAAiC,CAC7B,OAAON,EAAM,IAAI,KAAK,cAAe,yBAA0B,IAAI,CAC/E,EAEQ,gBAAiB,CACb,OAAO,KAAK,MAAQ,KAAK,KAAK,UAAU,CAAC,GAAK,KAAK,KAAK,UAAU,CAAC,EAAE,iBAAmB,EACpG,CACA,EAEI,MAAM,SAAU,CACZ,MAAMO,EAAY,KAAK,oBAAoB,OAAS,EAAI,KAAK,oBAAoB,CAAC,EAAE,GAAK,KAEzF,KAAK,qBAAqBA,CAAS,EACnC,KAAK,oBAAsB,CAAC,KAAK,wBACjC,KAAK,0BAA4B,CAAC,KAAK,UAAU,uBAEjD,MAAM,KAAK,UAAS,EAEpB,KAAK,kBAAoB,CAAC,KAAK,SACvC,EAEI,MAAO,CACH,mBAAoB,CAChB,KAAK,QAAO,CACxB,EAOQ,oBAAoBC,EAAO,CACnBA,GACA,KAAK,QAAO,CAE5B,EASQ,oBAAoBA,EAAO,CACvB,KAAK,kBAAoBA,CACrC,CACA,EAEI,QAAS,CACL,WAAY,CACJ,KAAK,WAIT,KAAK,MAAM,aAAa,CACpC,EAEQ,qBAAqBD,EAAW,CACxB,KAAK,YAIT,KAAK,kBAAoBA,EACrC,EAEQ,iBAAiBL,EAAS,CACtB,MAAO,CACH,eAAgBA,EAAQ,KAAO,KAAK,iBACpD,CACA,EAEQ,yBAAyBA,EAAS,CAC9B,KAAK,qBAAqBA,EAAQ,EAAE,CAChD,EAEQ,sBAAsBA,EAAS,CAC3B,OAAO,KAAK,yBAAyB,2BAA2BA,CAAO,CACnF,EAEQ,MAAM,mBAAoB,CACtB,KAAK,UAAY,GAEjB,IAAIO,EAAiB,KAErB,GAAI,CACA,MAAM,KAAK,UAAS,EAEpB,MAAM,KAAK,yBAAyB,oBAAmB,EACvDA,EAAiB,KAAK,cAAc,OACpD,OAAqBC,EAAO,CACZ,KAAK,aAAaA,CAAK,EACvBD,EAAiB,KAAK,cAAc,OAEhCT,EAAM,IAAIU,EAAO,0BAA2B,IAAI,IAChD,KAAK,cAAgBA,EAAM,SAAS,KAAK,OAAO,CAAC,EAErE,QAAa,CACG,MAAM,KAAK,yBAAyB,oBAAmB,EACvD,KAAK,aAAeD,EAEpB,KAAK,UAAY,EACjC,CACA,EAEQ,MAAM,WAAY,CACd,MAAM,KAAK,8BAA8B,UAAU,KAAK,IAAI,CACxE,EAEQ,MAAM,SAAU,CACZ,GAAK,KAAK,oBAIV,MAAK,UAAY,GAEjB,GAAI,CACA,MAAME,EAAW,MAAM,KAAK,8BAA8B,QAAQ,KAAK,UAAU,GAAI,KAAK,iBAAiB,EAC3G,KAAK,KAAOA,EAAS,IACrC,OAAqBD,EAAO,CACZ,KAAK,aAAaA,CAAK,EACvB,KAAK,UAAY,GACjB,KAAK,UAAS,CAC9B,QAAa,CACG,KAAK,UAAY,EACjC,EACA,EAEQ,mBAAmBR,EAAS,CACxB,MAAO,CACH,iBAAkB,KAAK,YAAYA,CAAO,CAC1D,CACA,EAEQ,YAAYA,EAAS,CACjB,MAAMU,EAAWV,EAAQ,iBACzB,OAAOU,GACA,IAAI,KAAK,KAAK,MAAMA,EAAS,SAAS,CAAC,EAAK,IAAI,MAChD,IAAI,KAAK,KAAK,MAAMA,EAAS,OAAO,CAAC,GAAM,IAAI,IAClE,EAEQ,YAAYC,EAAO,CACf,OAAOb,EAAM,OAAO,SAASa,EAAO,KAAK,CACrD,EAEQ,eAAeX,EAAS,CACpB,OAAI,KAAK,YAAYA,CAAO,EACjB,KAAK,YAAYA,EAAQ,iBAAiB,eAAe,EAG7D,KAAK,YAAYA,EAAQ,QAAQ,CACpD,EAEQ,iBAAiBA,EAAS,CACtB,OAAOA,EAAQ,iBAAmB,KAAK,YAAYA,EAAQ,iBAAiB,eAAe,EAAI,KAAK,UAChH,EAEQ,gBAAgBA,EAAS,CACrB,OAAOF,EAAM,OAAO,KAChBE,EAAQ,iBAAmB,IAAI,KAAK,KAAK,MAAMA,EAAQ,iBAAiB,OAAO,CAAC,EAAI,IACpG,CACA,EAEQ,aAAaQ,EAAO,CAChB,KAAK,oBAAoBA,CAAK,CAC1C,EAEQ,sBAAuB,CACnB,KAAK,qBAAuB,EACxC,EAEQ,uBAAwB,CACpB,KAAK,qBAAuB,EACxC,EAEQ,oBAAqB,CACjB,KAAK,mBAAqB,EACtC,EAEQ,qBAAsB,CAClB,KAAK,mBAAqB,EACtC,EAEQ,MAAM,WAAY,CACd,KAAK,UAAY,GACjB,MAAM,KAAK,yBAAyB,WAAU,EAC9C,MAAM,KAAK,gBAAe,EAC1B,KAAK,UAAY,EAC7B,EAEQ,MAAM,iBAAkB,CACpB,KAAK,8BAA8B,gBAAe,EAAG,KAAMC,GAAa,CACpE,KAAK,aAAeA,EAAS,IAC7C,CAAa,EAAE,MAAMD,GAAS,CACd,MAAMI,EAAiBJ,EAAM,UAAYA,EAAM,SAAS,MAAQA,EAAM,SAAS,KAAK,QAAW,CAAA,EAE/F,GAAI,CAAC,MAAM,QAAQI,CAAa,EAAG,CAC/B,SAAS,MAAM,MAAM,KAAK,wBAAyBJ,CAAK,EACxD,MACpB,CAEgBI,EAAc,QAAQC,GAAK,CACvB,KAAK,wBAAwB,CACzB,OAAQ,GACR,UAAW,GACX,MAAO,GACP,MAAOA,EAAE,MACT,QAASA,EAAE,MACnC,CAAqB,CACrB,CAAiB,CACjB,CAAa,CACb,EAEQ,oBAAoBb,EAAS,CACzB,MAAI,CAACA,GAAW,CAACA,EAAQ,UACd,KAGJ,KAAK,UAAUA,EAAQ,UAAW,CACrC,aAAc,CAAC,IAAK,IAAK,IAAK,IAAK,KAAM,SAAU,IAAK,IAAI,EAC5D,aAAc,CAAC,OAAQ,SAAU,KAAK,CACtD,CAAa,CACb,EAEQ,kBAAmB,CACf,KAAK,iBAAmB,EACpC,EAEQ,mBAAoB,CAChB,KAAK,iBAAmB,EACpC,CACA,CACA"}